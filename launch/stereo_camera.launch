<launch>

  <!-- the camera parameters and calibration files are 
       selected according to the arguments -->

  <!-- defines which camera to use. examples:
        - camera_flex_narrow
        - camera_flex_wide
        - camera_comp_narrow
        - camera_comp_wide -->
  <arg name="camera" />

  <!-- defines the configuration of the camera, used to
       find the right calibration files. examples:
        - boxed_air
        - boxed_water
        - open_air
        - cylinder_air 
        - cylinder_water -->
  <arg name="configuration" />

  <!-- Defines the base topic name under which the images are published.
  	   The frame id is derived from this too (adding the suffix "_optical") -->
  <arg name="base_topic" default="$(arg camera)" />

  <arg name="manager" default="manager" />
  <arg name="standalone" default="false" />

  <group if="$(arg standalone)">
    <node pkg="camera1394stereo" type="camera1394stereo_node" name="$(arg base_topic)_node" output="screen" >
      <rosparam file="$(find fugu_configurations)/$(arg camera)/params.yaml" />
      <param name="frame_id" value="$(arg base_topic)_optical" />
      <param name="camera_info_url_left" value="file://$(find fugu_configurations)/$(arg camera)/calibration_$(arg configuration)_left.yaml" />
      <param name="camera_info_url_right" value="file://$(find fugu_configurations)/$(arg camera)/calibration_$(arg configuration)_right.yaml" />
      <remap from="stereo_camera" to="$(arg base_topic)" />
    </node>
  </group>

  <group unless="$(arg standalone)">
    <node pkg="nodelet" type="nodelet" name="$(arg base_topic)_node" output="screen"
          args="load camera1394stereo/driver $(arg manager)">
      <rosparam file="$(find fugu_configurations)/$(arg camera)/params.yaml" />
      <param name="frame_id" value="$(arg base_topic)_optical" />
      <param name="camera_info_url_left" value="file://$(find fugu_configurations)/$(arg camera)/calibration_$(arg configuration)_left.yaml" />
      <param name="camera_info_url_right" value="file://$(find fugu_configurations)/$(arg camera)/calibration_$(arg configuration)_right.yaml" />
      <remap from="stereo_camera" to="$(arg base_topic)" />
    </node>
  </group>

</launch>

